<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sidebar Example</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* Basic styling for the sidebar */
.sidebar {
  height: 100%;
  width: 250px; /* Adjust the width as needed */
  position: fixed;
  top: 0;
  left: 0;
  background-color: rgb(70, 70, 233);
  padding-top: 20px;
  transition: left 0.3s ease; /* Add transition for smoother animation */
  border-radius: 50px;
}

/* Style for the links in the sidebar */
.sidebar a {
  padding: 10px;
  text-decoration: none;
  display: block;
  color: white;
}

/* Style for the active link */
.sidebar a.active {
  background-color: #ddd;
}

/* Style for the content area */
.content {
  padding: 20px;
  transition: margin-left 0.3s ease; /* Add transition for smoother animation */

}

/* Some example content */
h1 {
  margin-top: 0;
}

/* Styling for the navbar */
.navbar {
  width: 100%;
  background-color: whitesmoke;
  color: #fff;
  padding: 10px 20px;
  box-sizing: border-box;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* Styling for the navigation items */
.navbar .nav-items {
  margin-right: auto; /* Push navigation items to the left */
}

/* Styling for the signup button */
.signup-btn {
  background-color: rgb(70, 70, 233);
  color: white;
  border: none;
  border-radius: 10px;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
}

/* Media query for responsiveness */
@media screen and (max-width: 768px) {
  body {
    overflow-x: hidden; /* Hide horizontal scrollbar */
  }
  .sidebar {
    width: calc(100% - 30px); /* Set width for sidebar on smaller screens */
    left: -100%; /* Initially hide the sidebar off-screen */
  }
  .content {
    margin-left: 0; /* Reset margin for main content */
  }
  .sidebar.open {
    left: 0; /* Move sidebar to show on screen */
  }
  .content.expand {
    margin-left: 0; /* Keep main content to the right of sidebar */
  }
  .toggle-btn {
    display: block;
    position: fixed;
    top: 20px;
    right: 20px; /* Adjust position to the right */
    background-color: white;
    color: #333;
    padding: 10px;
    cursor: pointer;
    z-index: 9999; /* Ensure the button is above other content */
    border: none;
  }
  .toggle-btn:focus {
    outline: none; /* Remove outline on focus */
  }
  .toggle-icon {
    width: 30px;
    height: 3px;
    background-color: #333;
    margin: 6px 0;
    transition: transform 0.3s ease; /* Add transition for smoother animation */
  }
  .toggle-icon.open {
    transform: rotate(45deg); /* Rotate icon to form 'X' shape when sidebar is open */
  }
  .navbar {
    flex-direction: row-reverse; /* Align items in reverse order */
  }
  .signup-btn {
    margin-right: 20px; /* Position signup button in the right corner */
  }
  .navbar .nav-items {
    margin-left: 20px; /* Add left margin for spacing */
  }
}

/* Additional styling for non-responsive layout */
@media screen and (min-width: 769px) {
  .sidebar {
    left: 0; /* Show sidebar by default on non-responsive layout */
  }
  .content {
    margin-left: 250px;

  
     /* Keep main content to the right of sidebar */
  }
  .toggle-btn {display: none;}
}
.square-card {
  display: flex;
  justify-content: space-between; /* Ensure equal spacing between columns */
  flex-wrap: wrap; /* Allow columns to wrap to the next line on smaller screens */
}

.card {
  flex-basis: calc(33.33% - 20px); /* Adjust the width of cards */

  margin-bottom: 20px; /* Add some space between cards */
  padding: 20px; /* Increase padding for better spacing */
  box-sizing: border-box;
}

.column {
  flex-basis: calc(33.33% - 20px); /* Adjust the width of the column */
  display: flex;
  flex-direction: column; /* Arrange cards vertically */
  justify-content: flex-start; /* Align cards at the start of the column */
}

@media screen and (max-width: 768px) {
  .square-card {
    margin-left: -38px;
    flex-direction: column; /* Display cards vertically on smaller screens */
    height: auto; /* Remove fixed height */
  }

  .card {
    flex-basis: calc(45% - 20px); /* Adjust width of cards */
    margin-bottom: 10px; /* Reduce space between cards */
    padding: 10px; /* Adjust padding for smaller screens */
    box-sizing: border-box; /* Include padding in the total width */
  }

  .main-content {
    padding: 0 20px; /* Adjust padding to fit cards better on smaller screens */
  }

}

h1:not(.no-bullet)::before, h2:not(.no-bullet)::before, h3:not(.no-bullet)::before, h4:not(.no-bullet)::before, h5:not(.no-bullet)::before, h6:not(.no-bullet)::before {
  content: "\25A0"; /* Unicode character for square */
  margin-right: 0.5em; /* Adjust the spacing between the bullet and the text */
  color: rgb(70, 70, 233); /* Set the color of the bullet */
}
.sidebar {
  z-index: 2; /* Ensure sidebar is above cards */
  position: fixed; /* Keep sidebar fixed when scrolling */
}

.content {
  z-index: 1; /* Ensure cards are below sidebar */
  position: relative; /* Set relative positioning for stacking context */
}

#archivePopup {
    display: none;
}


</style>
{% load static %}
</head>
<body>

<div class="navbar">
  <div class="nav-items">

  </div>
  <button class="signup-btn" >Sign Up</button>
  <button class="toggle-btn" onclick="toggleSidebar()">
    <span class="toggle-icon"></span>
    <span class="toggle-icon"></span>
    <span class="toggle-icon"></span>
  </button>
</div>

<div class="sidebar" id="sidebar"><a href="#" style="font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif; margin-top: 30px; font-size: 55px; font-style: inherit; margin-left: 20px;">
    <img src="{% static 'images/relationship.jpg' %}"  alt="..." style="height: 80px;width: 80px;">CRM
</a>


  <a href="#" style="font-weight: bolder;margin-left: 20px;margin-top: 30px;">Dashboard</a>
  <a href="#" style="font-weight: bolder;margin-left: 20px;margin-top: 30px;">Contacts</a>
  <a href="#" style="font-weight: bolder;margin-left: 20px;margin-top: 30px;">Accounts</a>
  <a href="#" style="font-weight: bolder;margin-left: 20px;margin-top: 30px;">Leads</a>
  <a href="#" style="font-weight: bolder;margin-left: 20px;margin-top: 30px;">Opportunities</a>
  <a href="{% url 'archive' %}" style="font-weight: bolder;margin-left: 20px;margin-top: 30px;">Archives</a>
</div>

<div class="content" id="content">
  <h1 class="no-bullet">Outbound Calls and Contracts</h1>

  <div class="main-content">
    <div class="square-card">
      <!-- First column -->
      <div class="card">
        <h2>Outbound calls</h2>
        <p> 2,794</p>
        <p style="color: red;"> 32%</p>
        <canvas id="chart1"></canvas>
      </div>
      <!-- Second column -->
      <div class="card">
        <h2>Demos</h2>
        <p> 52</p>
        <p style="color: red;"> 43%</p>
        <canvas id="chart2"></canvas>
      </div>
      <!-- Third column -->
      <div class="column">
        <div class="card"> 
          <h2>Contracts closed</h2>
          <p><span style="display: inline;font-weight: bolder;font-size: 45px;">22 <span style="color: red;">(-29%)</span></span></p>


        </div>
        <div class="card"> 
          <h2>Avg Contractvalue</h2>
          <p><span style="display: inline;font-weight: bolder;font-size: 45px;">44,970 <span style="color: red;">(-4%)</span></span></p>
        </div>
        <div class="card"> 
          <h2>Call/Contract Ratio</h2>
          <p><span style="display: inline;font-weight: bolder;font-size: 45px;">127 <span style="color: red;">(-2%)</span></span></p>
        </div>
      </div>
    </div>
  </div>
  <div id="archivePopup" class="popup" ondrop="drop(event)" ondragover="allowDrop(event)">
    <i class="fas fa-archive" style="font-size: 48px;"></i>
</div>

<div id="card1" class="card" draggable="true" ondragstart="drag(event)" ontouchstart="handleTouchStart(event)" ontouchmove="handleTouchMove(event)" ontouchend="handleTouchEnd(event)">Card 1</div>
<div id="card2" class="card" draggable="true" ondragstart="drag(event)" ontouchstart="handleTouchStart(event)" ontouchmove="handleTouchMove(event)" ontouchend="handleTouchEnd(event)">Card 2</div>
<div id="card3" class="card" draggable="true" ondragstart="drag(event)" ontouchstart="handleTouchStart(event)" ontouchmove="handleTouchMove(event)" ontouchend="handleTouchEnd(event)">Card 3</div>
<div id="card4" class="card" draggable="true" ondragstart="drag(event)" ontouchstart="handleTouchStart(event)" ontouchmove="handleTouchMove(event)" ontouchend="handleTouchEnd(event)">Card 4</div>
<div id="card5" class="card" draggable="true" ondragstart="drag(event)" ontouchstart="handleTouchStart(event)" ontouchmove="handleTouchMove(event)" ontouchend="handleTouchEnd(event)">Card 5</div>




  
</div>
 


<script>


function toggleSidebar() {
  var sidebar = document.getElementById("sidebar");
  var content = document.getElementById("content");
  sidebar.classList.toggle("open");
  content.classList.toggle("expand");
}
 // JavaScript to render pie charts
 document.addEventListener('DOMContentLoaded', function () {
    var ctx1 = document.getElementById('chart1').getContext('2d');
    var ctx2 = document.getElementById('chart2').getContext('2d');

    var data1 = {
      datasets: [{
        data: [32, 68], // Assuming 32% and 68%
        backgroundColor: [
          'rgba(0, 102, 204, 0.5)', // Light blue
          'rgba(0, 51, 102, 0.5)'    // Dark blue
        ],
        borderColor: [
          'rgba(0, 102, 204, 1)', // Light blue
          'rgba(0, 51, 102, 1)'    // Dark blue
        ],
        borderWidth: 1
      }]
    };

    var data2 = {
      datasets: [{
        data: [43, 57], // Assuming 43% and 57%
        backgroundColor: [
          'rgba(0, 102, 204, 0.5)', // Light blue
          'rgba(0, 51, 102, 0.5)'    // Dark blue
        ],
        borderColor: [
          'rgba(0, 102, 204, 1)', // Light blue
          'rgba(0, 51, 102, 1)'    // Dark blue
        ],
        borderWidth: 1
      }]
    };

    var options = {
      // Add options if needed
      legend: {
        display: false // Hide the legend
      }
    };

    new Chart(ctx1, {
      type: 'pie',
      data: data1,
      options: options
    });

    new Chart(ctx2, {
      type: 'pie',
      data: data2,
      options: options
    });
  });
 // Function to handle touch start event
 function handleTouchStart(event) {
    // Prevent default touch behavior to avoid issues with touch events
    event.preventDefault();

    // Confirm that event.target refers to the touched element
    console.log('Touched element:', event.target);

    // Get the touch target
    let touch = event.touches[0];

    // Store initial touch coordinates and card position
    console.log('Initial touch coordinates:', touch.clientX, touch.clientY);
    console.log('Initial card position:', event.target.offsetLeft, event.target.offsetTop);

    event.target.setAttribute('data-touchstart-x', touch.clientX);
    event.target.setAttribute('data-touchstart-y', touch.clientY);
    event.target.setAttribute('data-card-x', event.target.offsetLeft);
    event.target.setAttribute('data-card-y', event.target.offsetTop);
}


/// Function to handle touch move event
function handleTouchMove(event) {
    // Prevent default touch behavior to avoid issues with touch events
    event.preventDefault();
    
    // Get the touch target
    let touch = event.touches[0];
    
    // Log touch coordinates for debugging
    console.log("Touch coordinates:", touch.clientX, touch.clientY);
    
    // Calculate distance moved
    let deltaX = touch.clientX - parseInt(event.target.getAttribute('data-touchstart-x'));
    let deltaY = touch.clientY - parseInt(event.target.getAttribute('data-touchstart-y'));
    
    // Log calculated distances for debugging
    console.log("Delta X:", deltaX, "Delta Y:", deltaY);
    
    // Calculate new card position
    let newCardX = parseInt(event.target.getAttribute('data-card-x')) + deltaX;
    let newCardY = parseInt(event.target.getAttribute('data-card-y')) + deltaY;
    
    // Apply translation to the card's position
    event.target.style.transform = `translate(${newCardX}px, ${newCardY}px)`;
}


// Function to handle touch end event
function handleTouchEnd(event) {
    // Reset card position after touchend
    event.target.style.transform = 'translate(0px, 0px)';

    // Confirm if event.preventDefault() is preventing default touch behavior
    console.log("Prevent Default:", event.defaultPrevented);

    // Get the touch position relative to the viewport
    var touchX = event.changedTouches[0].clientX;
    var touchY = event.changedTouches[0].clientY;
    console.log("Touch coordinates:", touchX, touchY);

    // Check if the touch ended within the boundaries of the archiveDiv
    var elementUnderTouch = document.elementFromPoint(touchX, touchY);
    console.log("Element under touch:", elementUnderTouch);

    // Add additional debugging or validation steps as needed
}

function dropTouch(event) {
    // Prevent the default behavior
    event.preventDefault();
    console.log("Prevent Default:", event.defaultPrevented);
    

    // Get the data (the card's ID) from the transfer
    var data = event.target.getAttribute("data-dragged-id");
    var draggedElement = document.getElementById(data);
    var archivePopup = document.getElementById("archivePopup");

    // Check if the touch ended within the boundaries of the archivePopup
    var touchX = event.changedTouches[0].clientX;
    var touchY = event.changedTouches[0].clientY;
    console.log("Touch coordinates:", touchX, touchY);

    // Check if the logic for archiving the card and storing it in local storage is functioning correctly
    var rect = archivePopup.getBoundingClientRect();
    console.log("Archive popup bounding rect:", rect);

    // Add additional debugging or validation steps as needed
}

// Function to handle mouse drag start event
function drag(event) {
    // Show the archive popup when a card is being dragged
    var archivePopup = document.getElementById("archivePopup");
    archivePopup.style.display = "block";

    // Set the data to be transferred (the card's ID)
    event.dataTransfer.setData("text", event.target.id);
}

// Function to handle mouse drag over event
function allowDrop(event) {
    // Allow dropping the card onto the archive popup
    event.preventDefault();
}

// Function to handle mouse drop event
function drop(event) {
    // Prevent the default behavior
    event.preventDefault();

    // Get the data (the card's ID) from the transfer
    var data = event.dataTransfer.getData("text");
    var draggedElement = document.getElementById(data);
    var archivePopup = document.getElementById("archivePopup");

    // Hide the archive popup after the drop
    archivePopup.style.display = "none";

    // Store the archived card's information in local storage
    var archivedCards = JSON.parse(localStorage.getItem("archivedCards")) || [];
    archivedCards.push({
        id: draggedElement.id,
        content: draggedElement.innerText
    });
    localStorage.setItem("archivedCards", JSON.stringify(archivedCards));

    // Remove the card from the dashboard
    draggedElement.remove();
}

// Attach drag and drop event listeners to the archive popup
var archivePopup = document.getElementById("archivePopup");
archivePopup.addEventListener("dragover", allowDrop);
archivePopup.addEventListener("drop", drop);
// Function to check if a card is archived
function isArchived(cardId) {
    var archivedCards = JSON.parse(localStorage.getItem("archivedCards")) || [];
    return archivedCards.some(function(card) {
        return card.id === cardId;
    });
}

// Function to update the display of archived cards in the dashboard
function updateArchivedCardDisplay() {
    var cards = document.querySelectorAll('.card');
    cards.forEach(function(card) {
        if (isArchived(card.id)) {
            card.style.display = 'none'; // Hide archived cards
        } else {
            card.style.display = 'block'; // Show non-archived cards
        }
    });
}

// Call the function to update the display of archived cards initially
updateArchivedCardDisplay();


</script>

</body>
</html>
